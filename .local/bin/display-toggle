#!/bin/sh

set_cmd() {
	output="$1"

	cmd="$cmd --output $output --auto --scale 1.0x1.0"
	if [ -n "$left" ]; then
		cmd="$cmd --right-of $left"
	fi
	left="$output"
}

connected_displays=$(xrandr | awk '/ connected / {print $1}')
active_displays=$(xrandr --listmonitors | awk 'NR>1 {print $4}')
i=0

for output in $connected_displays; do
	echo "$active_displays" | grep -qx "$output"
	is_active=$?

	if [ "$i" -eq "$1" ]; then
		if [ "$is_active" -eq 0 ]; then
			cmd="$cmd --output $output --off"
		else
			set_cmd "$output"
		fi
	elif [ "$is_active" -eq 0 ]; then
		set_cmd "$output"
	fi

	i=$((i + 1))
done

xrandr $cmd
